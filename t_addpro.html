<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="Access-Control-Allow-Origin" content="*">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link href="css/mui.min.css" rel="stylesheet" />
		<link href="css/style.css" rel="stylesheet" />
		<title>添加题目</title>
		<style>
			body{
				background-color:#F3F3F3;
			}
		
.login_btn{
	width:300px;
	margin:30px auto 0 auto;
}
.login_btn button{
	width:100%;
	margin:0;
	padding:.3em 0;
	-webkit-border-radius:.3em;
	-moz-border-radius: .3em;
	border:#1263be solid 1px;
	background-color: #29C4B5;
	color:#FFF;
	font-size:17px;
	font-weight:bolder;
	letter-spacing:1em;
}
.login_btn button:hover{
	background-color: cadetblue;
	}
	.mui-content{
		margin-top:5%;
	}
	.orl{
	background-color: white;
	color:#5E5E5E;
}
.active{
	background-color: #29C4B5;
	color:#FFFFFF;
}
		</style>
	</head>
	<body>
		<header class="mui-bar mui-bar-nav">
         <a class="mui-icon mui-icon-left-nav mui-pull-left" id="back"></a>
			<h1 class="mui-title">添加题目</h1>
		</header>
		<div class="mui-content">
				<div class="mui-input-row">
					<p style="margin-left: 3%;">题型</p>
					<p>
					<select id="protype" >
					<option value="4">多选题</option>
					<option value="1">单选题</option>
					<option value="3">填空题</option>
					<option value="2">判断题</option>
				    </select>
					</p>
				</div>
				<div class="mui-input-row">
					<p style="margin-left: 3%;">题干</p>
					<textarea style="height: 150px;" id="stem"></textarea>
				</div>
				<div class="mui-input-row" id="xuanxiang">
					<p style="margin-left: 3%;">选项</p>
					<input name="p_choice" type="text" class="mui-input-clear mui-input" >
				</div>
				<button id='choice' class="mui-btn mui-btn-block mui-btn-primary" style="height:20px;background-color:'#FFFFFF';text-align: center; line-height: 5px">+</button>;
		        <div class="mui-input-row" >
					<p style="margin-left: 3%;">答案</p>
					<input id="f_answer" type="text" class="mui-input-clear mui-input" name="selects">
					<button  id="A" class="orl" name="selects" >A</button>
					<button  id="B" class="orl" name="selects">B</button>
					<button  id="C" class="orl" name="selects">C</button>
					<button  id="D" class="orl" name="selects">D</button>
					<button  id="Y" class="orl" name="selects">Y</button>
					<button  id="N" class="orl" name="selects">N</button>
				</div>
				<div class="mui-input-row" >
					<p style="margin-left: 3%;margin-top: 2%;">答题解析</p>
					<input id="answerkey" type="text" class="mui-input-clear mui-input" >
				</div>
				<div class="mui-input-row">
					<p style="margin-left: 3%;">题目等级</p>
					<p>
					<select id="level" >
					<option value="1">基础知识</option>
					<option value="2">知识应用</option>
					<option value="3">能力提高</option>
				    </select>
					</p>
				</div>
				<div class="mui-input-row" >
					<p style="margin-left: 3%;">题目序号</p>
					<input id="q_order" type="text" class="mui-input-clear mui-input" >
				</div>
				<div class="mui-input-row" >
					<p style="margin-left: 3%;">题目分值</p>
					<input id="point" type="text" class="mui-input-clear mui-input" >
				</div>
				<div class="mui-input-row" id="tags">
					<p style="margin-left: 3%;">题目标签</p>
					<input name="tag" type="text" class="mui-input-clear mui-input" >
				</div>
				<button id='addtag' class="mui-btn mui-btn-block mui-btn-primary" style="height:20px;background-color:'#FFFFFF';text-align: center; line-height: 5px">+</button>
		</div>
		<div class="mui-content-padded">
				<div class="login_btn">
				  <button id='login' class="mui-btn mui-btn-block mui-btn-primary">添加</button>
				</div>
				
		</div>
		<script src="js/mui.min.js"></script>
            <script src="js/tool.js"></script>
            <script>
            	var title = UrlParm.parm("title");
            	var paperid = UrlParm.parm("paperid");
            	var qid= UrlParm.parm("qid");
            	document.getElementById('back').href='t_paperdetail.html?paperid='+paperid+'&title='+title+'&p_order=1'+'&qid='+qid;
				document.getElementById('A').onclick=function(){
                                if(document.getElementById('A').className.indexOf('active')>=0){ //说明已经是选中状态
                                    document.getElementById('A').className='orl';
                                    document.getElementById('A').style.backgroundColor="#FFFFFF";
                                    document.getElementById('A').style.color="#5E5E5E";
                                    
                                }
                                else if(document.getElementById('A').className.indexOf('orl')>=0){
                                    document.getElementById('A').className = 'active';//否则选中它，给它添加active样式
                                  document.getElementById('A').style.backgroundColor="#29C4B5";
                                    document.getElementById('A').style.color="#FFFFFF";
                                }
            	        }
				document.getElementById('B').onclick=function(){
                                if(document.getElementById('B').className.indexOf('active')>=0){ //说明已经是选中状态
                                    document.getElementById('B').className='orl';
                                    document.getElementById('B').style.backgroundColor="#FFFFFF";
                                    document.getElementById('B').style.color="#5E5E5E";
                                    
                                }
                                else if(document.getElementById('B').className.indexOf('orl')>=0){
                                    document.getElementById('B').className = 'active';//否则选中它，给它添加active样式
                                  document.getElementById('B').style.backgroundColor="#29C4B5";
                                    document.getElementById('B').style.color="#FFFFFF";
                                }
            	         }
				document.getElementById('C').onclick=function(){
                                if(document.getElementById('C').className.indexOf('active')>=0){ //说明已经是选中状态
                                    document.getElementById('C').className='orl';
                                    document.getElementById('C').style.backgroundColor="#FFFFFF";
                                    document.getElementById('C').style.color="#5E5E5E";
                                    
                                }
                                else if(document.getElementById('C').className.indexOf('orl')>=0){
                                    document.getElementById('C').className = 'active';//否则选中它，给它添加active样式
                                  document.getElementById('C').style.backgroundColor="#29C4B5";
                                    document.getElementById('C').style.color="#FFFFFF";
                                }
            	          }
				document.getElementById('D').onclick=function(){
                                if(document.getElementById('D').className.indexOf('active')>=0){ //说明已经是选中状态
                                    document.getElementById('D').className='orl';
                                    document.getElementById('D').style.backgroundColor="#FFFFFF";
                                    document.getElementById('D').style.color="#5E5E5E";
                                    
                                }
                                else if(document.getElementById('D').className.indexOf('orl')>=0){
                                    document.getElementById('D').className = 'active';//否则选中它，给它添加active样式
                                  document.getElementById('D').style.backgroundColor="#29C4B5";
                                    document.getElementById('D').style.color="#FFFFFF";
                                }
            	        }
				document.getElementById('Y').onclick=function(){
                                if(document.getElementById('Y').className.indexOf('active')>=0){ //说明已经是选中状态
                                    document.getElementById('Y').className='orl';
                                    document.getElementById('Y').style.backgroundColor="#FFFFFF";
                                    document.getElementById('Y').style.color="#5E5E5E";
                                    
                                }
                                else if(document.getElementById('Y').className.indexOf('orl')>=0){
                                    document.getElementById('Y').className = 'active';//否则选中它，给它添加active样式
                                  document.getElementById('Y').style.backgroundColor="#29C4B5";
                                    document.getElementById('Y').style.color="#FFFFFF";
                                }
            	        }
				document.getElementById('N').onclick=function(){
                                if(document.getElementById('N').className.indexOf('active')>=0){ //说明已经是选中状态
                                    document.getElementById('N').className='orl';
                                    document.getElementById('N').style.backgroundColor="#FFFFFF";
                                    document.getElementById('N').style.color="#5E5E5E";
                                    
                                }
                                else if(document.getElementById('N').className.indexOf('orl')>=0){
                                    document.getElementById('N').className = 'active';//否则选中它，给它添加active样式
                                  document.getElementById('N').style.backgroundColor="#29C4B5";
                                    document.getElementById('N').style.color="#FFFFFF";
                                }
            	       }
				var userid = GetUseridCookie().get("userid");	
            	if(userid=='undefined'){
            		alert("登录过期，请重新登录！");
					javascript:window.location.href="login.html"
            	}
            	(function($,doc){
				    var submit = document.getElementById('login');
				    var addchoice = document.getElementById('choice');
				    var addtag = document.getElementById('addtag');
				     addtag.onclick=function(){
				    	var input=document.createElement('input');
				    	input.type='text';
				    	input.className='mui-input-clear mui-input';
				    	input.name='tag';
				    	document.getElementById('tags').appendChild(input);
				    }
				    addchoice.onclick=function(){
				    	var input=document.createElement('input');
				    	input.type='text';
				    	input.className='mui-input-clear mui-input';
				    	input.name='p_choice';
				    	document.getElementById('xuanxiang').appendChild(input);
				    }
				    var protype=document.getElementById('protype');
				    var tagbtn=document.getElementsByName('tag');
				    var selectbtn=document.getElementsByName('selects');
				    var p_choicebtn=document.getElementsByName('p_choice');
				    var stem=document.getElementById('stem');
				    var answerkey=document.getElementById('answerkey');
				    var level=document.getElementById('level');
            		submit.onclick = function() {
            		var tag=''
				    for(var i=0;i<tagbtn.length-1;i++)
				    {
				    	tag=tag+tagbtn[i].value+',';
				    }
				    tag=tag+tagbtn[tagbtn.length-1].value;
				    var choices='';
				    for(var i=0;i<p_choicebtn.length-1;i++)
				    {
				    	choices=choices+p_choicebtn[i].value+'@@';
				    }
				    choices=choices+p_choicebtn[p_choicebtn.length-1].value;
				    var answer='';
				    if(protype.value==3)
				    {
				    	answer=selectbtn[0].value;
				    }
				    else if(protype.value==1||protype.value==4)
				    {
				       for(i=1;i<=4;i++)
				      {
				    	if(selectbtn[i].className.indexOf('active')>=0)
				    	{
				    		answer=answer+selectbtn[i].innerHTML;
				    	}
				      }
				    }
				    else
				    {
				    	 for(i=5;i<=6;i++)
				      {
				    	if(selectbtn[i].className.indexOf('active')>=0)
				    	{
				    		answer=answer+selectbtn[i].innerHTML;
				    	}
				      }
				    }
				    var question = {};
                    question.answer = answer;
                    question.answerkey = answerkey.value;
                    question.choices=choices;
                    question.level=level.value;
                    question.point=point.value;
                    question.q_order=q_order.value;
                    question.stem=stem.value;
                    question.tag=tag;
                    question.type=protype.value;
                    var data={};
                    data.question=question;
                    data.paperid=paperid;
                    data.qtype=protype.value;
				    mui.ajax('http://'+url+'/jizhibackend/servlet/AddPaperQuestionServlet',{
						data:JSON.stringify(data),
						xhrFields: {

							withCredentials: true

						},
						crossDomain: true,
						dataType: 'test', //服务器返回json格式数据
						type: 'post', //HTTP请求类型
						timeout: 10000, //超时时间设置为10秒；
						headers: { 'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8' },
						success: function(data) {
							mui.toast("添加题目成功");
							//javascript:window.location.href='t_paperdetail.html?paperid='+paperid+'&title='+title+'&p_order=1';
						},
						error: function(xhr, type, errorThrown) {
							console.log(errorThrown);
						}
					});
				}
					}
            )(mui.document);
            </script>
	</body>
</html>
