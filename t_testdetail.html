<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
	<title>测试题目</title>
	<link rel="stylesheet" type="text/css" href="css/prostyle.css" />
	<script type="text/javascript" src="js/jquery-3.2.1.min.js"></script>
	<link rel="stylesheet" href="css/mui.min.css">
	<script src="js/mui.min.js"></script>
    <script src="js/tool.js"></script>
	<style >
					body{
				background-color: #F3F3F3;
			}
			.header{
	 background-color:#29c4b5;
	 
	padding-bottom: 5px;
	 }
.topper
{
	 font-size: 20px;
	 margin:0;
	 padding-top: 1px;
	 padding-bottom: 4px;
	 text-align: center;
	 font-weight:bold;
     color:#FFFFFF;
}
#stem{
marker: 30%;
}
button{
	width: 50px;
	height: 50px;
	border-radius: 25px;
	border:#5E5E5E solid 1px;
	font-size:10px;
	font-weight:bolder;
}
.orl{
	background-color: white;
	color:#5E5E5E;
}
.active{
	background-color: #29C4B5;
	color:#FFFFFF;
}
#choicess{
	margin-bottom: 5%;;
}
#final{
	position: fixed;
}
#choice{
	width:600;
	height:70 ;
	border:0;
}
#finish{
	margin-left: 15%;
	border:#5E5E5E solid 1px;
	color:#1D7DB1;
	font-size:15px;
	font-weight:bolder;
    width: 60px;
    height: 30px;
    display: inline-block;
    border:1px solid #1D7DB1;
    border-radius: 5px;
    background: #F0F0F0;
    text-align: center;
    line-height: 27px;
    text-decoration: none;
}
#finish:hover
{
	margin-left: 15%;
	border:#5E5E5E solid 1px;
	color:#F0F0F0;
	font-size:15px;
	font-weight:bolder;
    width: 60px;
    height: 30px;
    display: inline-block;
    border:1px solid #1D7DB1;
    border-radius: 5px;
    background: #1D7DB1;
    text-align: center;
    line-height: 27px;
    text-decoration: none;
}
#pre{
	margin-left: 15%;
	border:#5E5E5E solid 1px;
	color:#1D7DB1;
	font-size:15px;
	font-weight:bolder;
	border:1px solid #1D7DB1;
    width: 60px;
    height: 30px;
    display: inline-block;
    border-radius: 5px;
    background: #F0F0F0;
    text-align: center;
    line-height: 27px;
    text-decoration: none;
}
#pre:hover
{
	margin-left: 15%;
	border:#5E5E5E solid 1px;
	color:#F0F0F0;
	font-size:15px;
	font-weight:bolder;
    width: 60px;
    height: 30px;
    display: inline-block;
    border:1px solid #1D7DB1;
    border-radius: 5px;
    background: #1D7DB1;
    text-align: center;
    line-height: 27px;
    text-decoration: none;
}
#next{
	margin-left: 15%;
	border:#5E5E5E solid 1px;
	border:1px solid #1D7DB1;
	color:#1D7DB1;
	font-size:15px;
	font-weight:bolder;
    width: 60px;
    height: 30px;
    display: inline-block;
    border-radius: 5px;
    background: #F0F0F0;
    text-align: center;
    line-height: 27px;
    text-decoration: none;
}
#next:hover
{
	margin-left: 15%;
	border:#5E5E5E solid 1px;
	color:#F0F0F0;
	font-size:15px;
	font-weight:bolder;
    width: 60px;
    height: 30px;
    display: inline-block;
    border:1px solid #1D7DB1;
    border-radius: 5px;
    background: #1D7DB1;
    text-align: center;
    line-height: 27px;
    text-decoration: none;
}
.oa-contact-cell{
	margin-top: 1 %;
	margin-bottom: 3%;
}
/*.nav-next{
	width: 200px;
	height: 50px;
	margin-top: 5%;
	border-radius: 25px;
	background-color: #66AFE9;
	border:#5E5E5E solid 1px;
	color:#FFFFFF;
	font-size:10px;
	font-weight:bolder;
}
.nav-previous{
	width: 200px;
	height: 50px;
	border-radius: 25px;
	background-color: #66AFE9;
	border:#5E5E5E solid 1px;
	color:#FFFFFF;
	font-size:10px;
	font-weight:bolder;
}*/
.in{
	width: 200px;
	height: 100px;
}
#list
{
	margin-right: 2%;
	margin-left:2% ;
	margin-bottom:3%;
}
	</style>
	
</head>
<body>
	<header class="mui-bar mui-bar-nav">
		   <a class="mui-icon mui-icon-arrowleft" id="back"></a>
			<h1 class="mui-title" id="title"></h1>
   </header>
<div class="mui-content">
	<canvas id="choice"style="border:0;width:100%;height: 100%;"></canvas>
	
	<div id="content">
		
		<!--<div id="choices">
			<button id="a">A</button><span>&nbsp;<i id="ca">ssss</i></span>
		</div>
		<div id="choices">
			<button id="b">B</button><span>&nbsp;<i id="cb">ssss</i></span>
		</div>
		<div id="choices">
			<button id="c">C</button><span>&nbsp;<i id="cc">ssss</i></span>
		</div>
		<div id="choices">
			<button id="d">D</button><span>&nbsp;<i id="cd">ssss</i></span>
		</div>-->
	</div>
	<div id="detaile">
		
	</div>
	<p>题目列表</p>
	<div id="lists">
		
	</div>
	<!--<div id="pree"><a class="nav-show-result" id="pre">上一题</button></div>
	<div id="nextt"><a class="nav-show-result" id="next">下一题</button></div>
	<div id="final" ><button class="finish" id="finish">交卷</button></div>-->
</div>
<script>
	jQuery.noConflict();
	jQuery("#choice").attr("width", jQuery(window).get(0).innerWidth);  
    jQuery("#choice").attr("height", 70);

    //ctx.strokeText('1/1',gWinWidth-40,47);
    mui('body').on('tap','a',function(){document.location.href=this.href;});
		mui.init({
			swipeBack:true //启用右滑关闭功能
		});
				var paperid=UrlParm.parm("paperid");
				var title=UrlParm.parm("title");
				var testid=UrlParm.parm("testid");
				var order;
				var q_order=UrlParm.parm("q_order");
				var userid = GetUseridCookie().get("userid");
				var content = document.getElementById("content");
				var detail=document.getElementById('detail');
				var t=UrlParm.parm("title");
				document.getElementById('title').innerHTML=t;	
				document.getElementById('back').href="new_t_datijiguo.html?testid="+testid+'&use_paperid='+paperid;
					mui.ajax('http://'+url+'/jizhibackend/servlet/EnterTest',{
						data:
						{
							userid:userid,
							testid:testid,
						},
						xhrFields: {

							withCredentials: true

						},
						crossDomain: true,
						dataType: 'json', //服务器返回json格式数据
						type: 'post', //HTTP请求类型
						timeout: 10000, //超时时间设置为10秒；
						headers: { 'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8' },
						success: function(data) {
							gettest(data,1);
						},
						error: function(xhr, type, errorThrown) {
							console.log(errorThrown);
						}
					});
		    type=[];
		    var div=new Array();
		    function show(data,qorder,total,qtype)
			{
				        content.innerHTML='';
				        content.appendChild(div[qorder-1]);
				        order=qorder;
				        var f_data = JSON.stringify(data).replace(/\"/g,"'");
				        gWinWidth = jQuery(window).get(0).innerWidth;
	                    var c=document.getElementById('choice'); 
	                    var userid = GetUseridCookie().get("userid");
	                    var ctx=c.getContext("2d");
	                    var cty=c.getContext("2d");
	                    cty.beginPath();
                        cty.moveTo(0,20);
                        cty.lineTo(0,70);
                        cty.lineTo(50,70);
                        cty.lineTo(70,45);
                        cty.lineTo(50,20);  
                        cty.closePath();
                        cty.stroke();
                        cty.fillStyle="lightseagreen"
                        cty.fill();
                      //cty.strokeText('填空题',10,47);
                        ctx.beginPath();
                        ctx.moveTo(50,20);
                        ctx.lineTo(70,45);
                        ctx.lineTo(50,70);
                        ctx.lineTo(gWinWidth,70);
                        ctx.lineTo(gWinWidth,20);
                        ctx.closePath();
                        ctx.stroke();
                        ctx.fillStyle="white"
                        ctx.fill();
                        if(type[q_order-1]==4)
                        {
                        	cty.strokeText('多选题',10,47);
                        	ctx.strokeText(q_order+'/'+total,gWinWidth-40,47);
                        	
                        }
                        else if(type[q_order-1]==1)
                        {
                        	cty.strokeText('单选题',10,47);
                        	ctx.strokeText(q_order+'/'+total,gWinWidth-40,47);
                        }
                        else if(type[q_order-1]==3)
                        {
                        	cty.strokeText('填空题',10,47);
                        	ctx.strokeText(q_order+'/'+total,gWinWidth-40,47);
                        	
                        }
                        else if(type[q_order-1]==2)
                        {
                        	cty.strokeText('判断题',10,47)
                        	ctx.strokeText(q_order+'/'+total,gWinWidth-40,47);
                        	
                        }
			}
			function gettest(data){
				        var f_data = JSON.stringify(data).replace(/\"/g,"'");
				        var level=['基础知识','能力提升','扩展应用'];
						var data_m=data.MultipleChoiceQuestion;
						var data_s= data.SingleChoiceQuestion;
						var data_f= data.FillBlankQuestion;
						var data_j=data.JudgeQuestion;
						var total=data_m.length+data_s.length+data_f.length+data_j.length;
						var lists=document.getElementById('lists');
						var str='';
						qids=[];
                        choice=[];
						for( var i=0;i<(data_m.length+data_s.length+data_f.length+data_j.length);i++)
						{
							div[i] = document.createElement('div');
                 		    div[i].className="slid";
                 		   
                 		    
                      };
                    	for(var j=0;j<data_m.length;j++)
                 		{ 
                 			(function(arg_1){
                 			//cty.strokeText('多选题',10,47);
                 			type[data_m[j].q_order-1]=4;
                 			qids[data_m[j].q_order-1]=data_m[j].id;
                 			var name='choices'+data_m[j].q_order;
                 			var Am='a'+data_m[j].q_order;
                 		    var Bm='b'+data_m[j].q_order;
                 		    var Cm='c'+data_m[j].q_order;
                 		    var Dm='d'+data_m[j].q_order;
                        	//ctx.strokeText(data_m[j].q_order+'/'+total,gWinWidth-40,47);
                        	var div0=document.createElement('div');
                 		    div.id="stem";
                 		    var p=document.createElement('p');
                 		    p.id="stem1";
                 		    p.innerHTML=data_m[arg_1].stem;
                        	div0.appendChild(p);                	
                 	        div[data_m[j].q_order-1].appendChild(div0);
                        	str=data_m[arg_1].choices;
                        	choice=str.split("@@");
                        	//ontent.appendChild(div[data_m[j].q_order-1]);
                        	var div1 = document.createElement('div');
                 	         div1.id='choicess';
                 	         div1.innerHTML='<div style="width: 20%; height: 60px;padding: 10px;float: left;"><button name='+name+' id='+Am+' class="orl" >A</button></div><div id="ca" style="height:60px; width: 80%; float: left; padding: 20px;">'+
                 	                        choice[0]+'</div';
                 	        var div2 = document.createElement('div');
                 	        div2.id='choicess';
                 	        div2.innerHTML='<div style="width: 20%; height: 60px;padding: 10px;float: left;"><button name='+name+' id='+Bm+' class="orl" >B</button></div><div id="cb" style="height:60px; width: 80%; float: left; padding: 20px;">'+
                 	                         choice[1]+'</div>';
                 	        var div3 = document.createElement('div');
                 	        div3.id='choicess';
                 	         div3.innerHTML='<div style="width: 20%; height: 60px;padding: 10px;float: left;"><button name='+name+' id='+Cm+' class="orl" >C</button></div><div id="cc" style="height:60px; width: 80%; float: left; padding: 20px;">'+
                 	                         choice[2]+'</div>';
                 	        var div4 = document.createElement('div');
                 	        div4.id='choicess';
                 	        div4.innerHTML='<div style="width: 20%; height: 60px;padding: 10px;float: left;"><button name='+name+' id='+Dm+' class="orl" >D</button></div><div id="cd" style="height:60px; width: 80%; float: left; padding: 20px;">'+
                 	                         choice[3]+'</div>';
                 	        div[data_m[j].q_order-1].appendChild(div1);
                 	        div[data_m[j].q_order-1].appendChild(div2);
                 	        div[data_m[j].q_order-1].appendChild(div3);
                 	        div[data_m[j].q_order-1].appendChild(div4);
                 	        p1=document.createElement('p');
                 	        p2=document.createElement('p');
                 	        p3=document.createElement('p');
                 	        p4=document.createElement('p');
                 	        p1.innerHTML='正确答案：'+data_m[arg_1].answer;
                 	        p2.innerHTML='分值：'+data_m[arg_1].point;
                 	        p3.innerHTML='题目解析：'+data_m[arg_1].answerkey;
                 	        p4.innerHTML='题目难度：'+level[data_m[arg_1].level];
                 	        div[data_m[j].q_order-1].appendChild(p1);
                 	        div[data_m[j].q_order-1].appendChild(p2);
                 	        div[data_m[j].q_order-1].appendChild(p3);
                 	        div[data_m[j].q_order-1].appendChild(p4);
                          })(j);
                        }
                        for(var j=0;j<data_s.length;j++)
                        {
                        	
                        	(function(arg_1){
                 			//cty.strokeText('单选题',10,47);
                 			type[data_s[j].q_order-1]=1;
                 			qids[data_s[j].q_order-1]=data_s[j].id;
                        	//ctx.strokeText(data_m[j].q_order+'/'+total,gWinWidth-40,47);
                        	var div0=document.createElement('div');
                 		    div.id="stem";
                 		    var name='choices'+data_s[j].q_order;
                 		    var A='a'+data_s[j].q_order;
                 		    var B='b'+data_s[j].q_order;
                 		    var C='c'+data_s[j].q_order;
                 		    var D='d'+data_s[j].q_order;
                 		    var p=document.createElement('p');
                 		    p.id="stem1";
                 		    p.innerHTML=data_s[arg_1].stem;
                        	div0.appendChild(p);                	
                 	        div[data_s[j].q_order-1].appendChild(div0);
                        	str=data_s[arg_1].choices;
                        	choice=str.split("@@");
                        	//content.appendChild(div[data_s[j].q_order-1]);
                        	var div1 = document.createElement('div');
                 	         div1.id='choicess';
                 	        div1.innerHTML='<div style="width: 20%; height: 60px;padding: 10px;float: left;"><button name='+name+' id='+A+' class="orl" >A</button></div><div id="ca" style="height:60px; width: 80%; float: left; padding: 20px;">'+
                 	                        choice[0]+'</div';
                 	        var div2 = document.createElement('div');
                 	        div2.id='choicess';
                 	        div2.innerHTML='<div style="width: 20%; height: 60px;padding: 10px;float: left;"><button name='+name+' id='+B+' class="orl" >B</button></div><div id="cb" style="height:60px; width: 80%; float: left; padding: 20px;">'+
                 	                         choice[1]+'</div>';
                 	        var div3 = document.createElement('div');
                 	        div3.id='choicess';
                 	         div3.innerHTML='<div style="width: 20%; height: 60px;padding: 10px;float: left;"><button name='+name+' id='+C+' class="orl" >C</button></div><div id="cc" style="height:60px; width: 80%; float: left; padding: 20px;">'+
                 	                         choice[2]+'</div>';
                 	        var div4 = document.createElement('div');
                 	        div4.id='choicess';
                 	         div4.innerHTML='<div style="width: 20%; height: 60px;padding: 10px;float: left;"><button name='+name+' id='+D+' class="orl" >D</button></div><div id="cd" style="height:60px; width: 80%; float: left; padding: 20px;">'+
                 	                         choice[3]+'</div>';
                 	        //content.appendChild(div[arg]);
                 	        div[data_s[j].q_order-1].appendChild(div1);
                 	        div[data_s[j].q_order-1].appendChild(div2);
                 	        div[data_s[j].q_order-1].appendChild(div3);
                 	        div[data_s[j].q_order-1].appendChild(div4);
                 	       	var a_s = document.getElementById(A);
                            var b_s = document.getElementById(B);
                            var c_s = document.getElementById(C);
                            var d_s = document.getElementById(D);
                             p1=document.createElement('p');
                 	        p2=document.createElement('p');
                 	        p3=document.createElement('p');
                 	        p4=document.createElement('p');
                 	        p1.innerHTML='正确答案：'+data_s[arg_1].answer;
                 	        p2.innerHTML='分值：'+data_s[arg_1].point;
                 	        p3.innerHTML='题目解析：'+data_s[arg_1].answerkey;
                 	        p4.innerHTML='题目难度：'+level[data_s[arg_1].level];
                 	        div[data_s[j].q_order-1].appendChild(p1);
                 	        div[data_s[j].q_order-1].appendChild(p2);
                 	        div[data_s[j].q_order-1].appendChild(p3);
                 	        div[data_s[j].q_order-1].appendChild(p4);
                          })(j);
                        }
                        for(var j=0;j<data_f.length;j++)
                        {
                           (function(arg_1){
                        	type[data_f[j].q_order-1]=3;
                        	qids[data_f[j].q_order-1]=data_f[j].id;
                        	var name='choices'+data_f[j].q_order;
                        	//cty.strokeText('填空题',10,47);
                        	//ctx.strokeText(data_f[j].q_order+'/'+total,gWinWidth-40,47);
                        	var div0=document.createElement('div');
                 		    div0.id="stem";
                 		    var p=document.createElement('p');
                 		    p.id="stem1";
                 		    p.innerHTML=data_f[arg_1].stem;
                        	div0.appendChild(p);
                 	        div[data_f[j].q_order-1].appendChild(div0);
                        	//stem1.innerHTML=data_f[arg_1].stem;
                        	var div1 = document.createElement('div');
                        	div1.innerHTML='<input type="text" name='+name+' id="in" class="in" >';
                        	div[data_f[j].q_order-1].appendChild(div1);
                        	 p1=document.createElement('p');
                 	        p2=document.createElement('p');
                 	        p3=document.createElement('p');
                 	        p4=document.createElement('p');
                 	        p1.innerHTML='正确答案：'+data_f[arg_1].answer;
                 	        p2.innerHTML='分值：'+data_f[arg_1].point;
                 	        p3.innerHTML='题目解析：'+data_f[arg_1].answerkey;
                 	        p4.innerHTML='题目难度：'+level[data_f[arg_1].level];
                 	        div[data_f[j].q_order-1].appendChild(p1);
                 	        div[data_f[j].q_order-1].appendChild(p2);
                 	        div[data_f[j].q_order-1].appendChild(p3);
                 	        div[data_f[j].q_order-1].appendChild(p4);
                 		    //content.appendChild(div[data_f[j].q_order-1]);
                        })(j);
                        }
                        
                        for(var j=0;j<data_j.length;j++)
                        {
                        	(function(arg_1){
                        	type[data_j[j].q_order-1]=2;
                        	qids[data_j[j].q_order-1]=data_j[j].id;
                        	var name='choices'+data_j[j].q_order;
                        	 var Aj='a'+data_j[j].q_order;
                 		     var Bj='b'+data_j[j].q_order;
                        	//cty.strokeText('判断题',10,47);
                        	//ctx.strokeText(data_j[j].q_order+'/'+total,gWinWidth-40,47);
                        	var div0=document.createElement('div');
                 		    div.id="stem";
                 		    var p=document.createElement('p');
                 		    p.id="stem1";
                 		    p.innerHTML=data_j[arg_1].stem;
                        	div0.appendChild(p);                	
                 	        div[data_j[j].q_order-1].appendChild(div0);
                        	//stem1.innerHTML=data_j[arg_1].stem;
                        	var div1 = document.createElement('div');
                 	        div1.id='choicess';
                 	         div1.innerHTML='<div style="width: 20%; height: 60px;padding: 10px;float: left;"><button name='+name+' id='+Aj+' class="orl" >Y</button></div><div id="ca" style="height:60px; width: 80%; float: left; padding: 20px;">'+
                 	                       '正确</div';
                 	        var div2 = document.createElement('div');
                 	        div2.id='choicess';
                 	        div2.innerHTML='<div style="width: 20%; height: 60px;padding: 10px;float: left;"><button name='+name+' id='+Bj+' class="orl" >N</button></div><div id="cb" style="height:60px; width: 80%; float: left; padding: 20px;">'+
                 	                         '错误</div>';
                 	        //content.appendChild(div[data_j[j].q_order-1]);
                 	        div[data_j[j].q_order-1].appendChild(div1);
                 	        div[data_j[j].q_order-1].appendChild(div2);
                 	        p1=document.createElement('p');
                 	        p2=document.createElement('p');
                 	        p3=document.createElement('p');
                 	        p4=document.createElement('p');
                 	        p1.innerHTML='正确答案：'+data_j[arg_1].answer;
                 	        p2.innerHTML='分值：'+data_j[arg_1].point;
                 	        p3.innerHTML='题目解析：'+data_j[arg_1].answerkey;
                 	        p4.innerHTML='题目难度：'+level[data_j[arg_1].level];
                 	        div[data_j[j].q_order-1].appendChild(p1);
                 	        div[data_j[j].q_order-1].appendChild(p2);
                 	        div[data_j[j].q_order-1].appendChild(p3);
                 	        div[data_j[j].q_order-1].appendChild(p4);
                 		    content.appendChild(div[data_j[j].q_order-1]);
                        })(j);
                        }
                        var str='';
                        for(var j=0;j<total;j++)
						{
							i=j+1;
						    str=str+'<button id="list" class="orl" onclick="show('+f_data+','+i+','+total+','+type[i]+')" >'+i+'</button>';
						    
						}
						lists.innerHTML=str;
						show(data,1,total,type[1]);
						
		}
			
             
</script>
</body>
</html>